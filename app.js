var Cm2k15;
(function (Cm2k15) {
    var GameTile = (function () {
        function GameTile(row, col, size, element) {
            console.log('gametile constructor:' + row + ',' + col);
            this.element = element;
            this.initialize(row, col, size);
        }
        GameTile.prototype.initialize = function (row, col, size) {
            this.element.style.top = row * size + 'px';
            this.element.style.left = col * size + 'px';
            this.element.style.width = this.element.style.height = size + 'px';
            this.element.className = 'tile';
        };
        GameTile.prototype.Reset = function () {
            this.element.innerText = "";
        };
        GameTile.prototype.Set = function (text) {
            this.element.innerText = text;
        };
        return GameTile;
    })();
    Cm2k15.GameTile = GameTile;
})(Cm2k15 || (Cm2k15 = {}));
var Cm2k15;
(function (Cm2k15) {
    var GamePlayer = (function () {
        function GamePlayer() {
            console.log('player constructor');
            this.position = 2;
        }
        GamePlayer.prototype.GetPosition = function () {
            return this.position;
        };
        GamePlayer.prototype.Move = function () {
            this.position++;
        };
        return GamePlayer;
    })();
    Cm2k15.GamePlayer = GamePlayer;
})(Cm2k15 || (Cm2k15 = {}));
/// <reference path="GameTile.ts"/>
/// <reference path="GamePlayer.ts"/>
var Cm2k15;
(function (Cm2k15) {
    var GameMap = (function () {
        function GameMap(map, player) {
            this.tileCount = 8;
            console.log('gamemap constructor');
            var mapWidth = map.clientWidth;
            var tileSize = mapWidth / this.tileCount;
            this.player = player;
            this.tiles = [];
            for (var i = 0; i < this.tileCount; i++) {
                this.tiles.push([]);
                for (var j = 0; j < this.tileCount; j++) {
                    var element = document.createElement('div');
                    this.tiles[i][j] = new Cm2k15.GameTile(i, j, tileSize, element);
                    map.appendChild(element);
                }
            }
        }
        GameMap.prototype.Display = function () {
            for (var i = 0; i < this.tileCount; i++) {
                for (var j = 0; j < this.tileCount; j++) {
                    if (i == this.player.GetPosition() && j == this.player.GetPosition()) {
                        this.tiles[i][j].Set('[x]');
                    }
                    else {
                        this.tiles[i][j].Reset();
                    }
                }
            }
        };
        return GameMap;
    })();
    Cm2k15.GameMap = GameMap;
})(Cm2k15 || (Cm2k15 = {}));
/// <reference path="GameMap.ts"/>
/// <reference path="GamePlayer.ts"/>
var Cm2k15;
(function (Cm2k15) {
    var Game = (function () {
        function Game(map, input) {
            var _this = this;
            console.log('game constructor');
            this.player = new Cm2k15.GamePlayer();
            this.map = new Cm2k15.GameMap(map, this.player);
            this.map.Display();
            input.onkeydown = function (e) {
                if (e.keyCode == 13) {
                    var command = input.value;
                    input.value = '';
                    _this.onCommand(command);
                    return false;
                }
            };
        }
        Game.prototype.onCommand = function (command) {
            console.log('Command: ' + command);
            if (command == 'move') {
                this.player.Move();
                this.map.Display();
            }
        };
        return Game;
    })();
    Cm2k15.Game = Game;
})(Cm2k15 || (Cm2k15 = {}));
/// <reference path="Game.ts"/>
var commandInput = document.getElementById('command');
var map = document.getElementById('map');
var game = new Cm2k15.Game(map, commandInput);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkdhbWVUaWxlLnRzIiwiR2FtZVBsYXllci50cyIsIkdhbWVNYXAudHMiLCJHYW1lLnRzIiwiYXBwLnRzIl0sIm5hbWVzIjpbIkNtMmsxNSIsIkNtMmsxNS5HYW1lVGlsZSIsIkNtMmsxNS5HYW1lVGlsZS5jb25zdHJ1Y3RvciIsIkNtMmsxNS5HYW1lVGlsZS5pbml0aWFsaXplIiwiQ20yazE1LkdhbWVUaWxlLlJlc2V0IiwiQ20yazE1LkdhbWVUaWxlLlNldCIsIkNtMmsxNS5HYW1lUGxheWVyIiwiQ20yazE1LkdhbWVQbGF5ZXIuY29uc3RydWN0b3IiLCJDbTJrMTUuR2FtZVBsYXllci5HZXRQb3NpdGlvbiIsIkNtMmsxNS5HYW1lUGxheWVyLk1vdmUiLCJDbTJrMTUuR2FtZU1hcCIsIkNtMmsxNS5HYW1lTWFwLmNvbnN0cnVjdG9yIiwiQ20yazE1LkdhbWVNYXAuRGlzcGxheSIsIkNtMmsxNS5HYW1lIiwiQ20yazE1LkdhbWUuY29uc3RydWN0b3IiLCJDbTJrMTUuR2FtZS5vbkNvbW1hbmQiXSwibWFwcGluZ3MiOiJBQUFBLElBQU8sTUFBTSxDQXlCWjtBQXpCRCxXQUFPLE1BQU0sRUFBQyxDQUFDO0lBQ2JBO1FBR0VDLGtCQUFtQkEsR0FBV0EsRUFBRUEsR0FBV0EsRUFBRUEsSUFBWUEsRUFBRUEsT0FBdUJBO1lBQ2hGQyxPQUFPQSxDQUFDQSxHQUFHQSxDQUFDQSx1QkFBdUJBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUdBLEdBQUdBLENBQUNBLENBQUNBO1lBQ3ZEQSxJQUFJQSxDQUFDQSxPQUFPQSxHQUFHQSxPQUFPQSxDQUFDQTtZQUN2QkEsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsR0FBR0EsRUFBQ0EsR0FBR0EsRUFBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDaENBLENBQUNBO1FBRU9ELDZCQUFVQSxHQUFsQkEsVUFBbUJBLEdBQVdBLEVBQUVBLEdBQVdBLEVBQUVBLElBQVlBO1lBQ3ZERSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxL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QVdBLEdBQUdBLE9BQU9BLENBQUNBLENBQUNBO1lBQ25DQSxFQUFFQSxDQUFDQSxDQUFDQSxPQUFPQSxJQUFJQSxNQUFNQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDdEJBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLElBQUlBLEVBQUVBLENBQUNBO2dCQUNuQkEsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsT0FBT0EsRUFBRUEsQ0FBQ0E7WUFDckJBLENBQUNBO1FBQ0hBLENBQUNBO1FBQ0pGLFdBQUNBO0lBQURBLENBOUJBYixBQThCQ2EsSUFBQWI7SUE5QllBLFdBQUlBLE9BOEJoQkEsQ0FBQUE7QUFDRkEsQ0FBQ0EsRUFoQ00sTUFBTSxLQUFOLE1BQU0sUUFnQ1o7QUNuQ0QsK0JBQStCO0FBRS9CLElBQUksWUFBWSxHQUF3QixRQUFRLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzNFLElBQUksR0FBRyxHQUFtQixRQUFRLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBRXpELElBQUksSUFBSSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsWUFBWSxDQUFDLENBQUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlIENtMmsxNSB7XHJcbiAgZXhwb3J0IGNsYXNzIEdhbWVUaWxlIHtcclxuICAgIHByaXZhdGUgZWxlbWVudDogSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlciwgc2l6ZTogbnVtYmVyLCBlbGVtZW50OiBIVE1MRGl2RWxlbWVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnZ2FtZXRpbGUgY29uc3RydWN0b3I6JyArIHJvdyArICcsJyArIGNvbCk7XHJcbiAgICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XHJcbiAgICAgIHRoaXMuaW5pdGlhbGl6ZShyb3csY29sLHNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZShyb3c6IG51bWJlciwgY29sOiBudW1iZXIsIHNpemU6IG51bWJlcil7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSByb3cqc2l6ZSArICdweCc7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5sZWZ0ID0gY29sKnNpemUgKyAncHgnO1xyXG4gICAgICB0aGlzLmVsZW1lbnQuc3R5bGUud2lkdGggPSB0aGlzLmVsZW1lbnQuc3R5bGUuaGVpZ2h0ID0gc2l6ZSArICdweCc7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5jbGFzc05hbWUgPSAndGlsZSc7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIFJlc2V0KCl7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5pbm5lclRleHQgPSBcIlwiO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBTZXQodGV4dDogc3RyaW5nKXtcclxuICAgICAgdGhpcy5lbGVtZW50LmlubmVyVGV4dCA9IHRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG59IiwibW9kdWxlIENtMmsxNSB7XHJcbiAgZXhwb3J0IGNsYXNzIEdhbWVQbGF5ZXIge1xyXG4gICAgcG9zaXRpb246IG51bWJlcjtcclxuXHJcbiAgICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwbGF5ZXIgY29uc3RydWN0b3InKTtcclxuICAgICAgdGhpcy5wb3NpdGlvbiA9IDI7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIEdldFBvc2l0aW9uKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgTW92ZSgpIHtcclxuICAgICAgdGhpcy5wb3NpdGlvbisrO1xyXG4gICAgfVxyXG4gIH1cclxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJHYW1lVGlsZS50c1wiLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkdhbWVQbGF5ZXIudHNcIi8+XHJcbm1vZHVsZSBDbTJrMTUge1xyXG4gIGV4cG9ydCBjbGFzcyBHYW1lTWFwIHtcclxuICAgIHRpbGVDb3VudCA9IDg7XHJcbiAgICB0aWxlczogR2FtZVRpbGVbXVtdO1xyXG4gICAgcGxheWVyOiBHYW1lUGxheWVyO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihtYXA6IEhUTUxEaXZFbGVtZW50LCBwbGF5ZXI6IEdhbWVQbGF5ZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coJ2dhbWVtYXAgY29uc3RydWN0b3InKTtcclxuXHJcbiAgICAgIHZhciBtYXBXaWR0aCA9IG1hcC5jbGllbnRXaWR0aDtcclxuICAgICAgdmFyIHRpbGVTaXplID0gbWFwV2lkdGggLyB0aGlzLnRpbGVDb3VudDtcclxuXHJcbiAgICAgIHRoaXMucGxheWVyID0gcGxheWVyO1xyXG4gICAgICB0aGlzLnRpbGVzID0gW107XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50aWxlQ291bnQ7IGkrKykgeyAgXHJcbiAgICAgICAgdGhpcy50aWxlcy5wdXNoKFtdKTtcclxuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMudGlsZUNvdW50OyBqKyspIHtcclxuICAgICAgICAgIHZhciBlbGVtZW50ID0gPEhUTUxEaXZFbGVtZW50PmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgdGhpcy50aWxlc1tpXVtqXSA9IG5ldyBHYW1lVGlsZShpLCBqLCB0aWxlU2l6ZSwgZWxlbWVudCk7XHJcbiAgICAgICAgICBtYXAuYXBwZW5kQ2hpbGQoZWxlbWVudCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIERpc3BsYXkoKSB7XHJcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50aWxlQ291bnQ7IGkrKykge1xyXG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy50aWxlQ291bnQ7IGorKykge1xyXG4gICAgICAgICAgaWYgKGkgPT0gdGhpcy5wbGF5ZXIuR2V0UG9zaXRpb24oKSAmJiBqID09IHRoaXMucGxheWVyLkdldFBvc2l0aW9uKCkpIHtcclxuICAgICAgICAgICAgdGhpcy50aWxlc1tpXVtqXS5TZXQoJ1t4XScpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy50aWxlc1tpXVtqXS5SZXNldCgpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJHYW1lTWFwLnRzXCIvPlxyXG4vLy8gPHJlZmVyZW5jZSBwYXRoPVwiR2FtZVBsYXllci50c1wiLz5cclxuXHJcbm1vZHVsZSBDbTJrMTUge1xyXG5cdGV4cG9ydCBjbGFzcyBHYW1lIHtcclxuXHJcbiAgICBwcml2YXRlIG1hcDogR2FtZU1hcDtcclxuICAgIHByaXZhdGUgcGxheWVyOiBHYW1lUGxheWVyO1xyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcihtYXA6IEhUTUxEaXZFbGVtZW50LCBpbnB1dDogSFRNTFRleHRBcmVhRWxlbWVudCkge1xyXG4gICAgICBjb25zb2xlLmxvZygnZ2FtZSBjb25zdHJ1Y3RvcicpO1xyXG5cclxuXHJcbiAgICAgIHRoaXMucGxheWVyID0gbmV3IEdhbWVQbGF5ZXIoKTtcclxuICAgICAgdGhpcy5tYXAgPSBuZXcgR2FtZU1hcChtYXAsIHRoaXMucGxheWVyKTtcclxuICAgICAgdGhpcy5tYXAuRGlzcGxheSgpO1xyXG5cclxuICAgICAgaW5wdXQub25rZXlkb3duID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuICAgICAgICBpZiAoZS5rZXlDb2RlID09IDEzKSB7XHJcbiAgICAgICAgICB2YXIgY29tbWFuZCA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcclxuICAgICAgICAgIHRoaXMub25Db21tYW5kKGNvbW1hbmQpO1xyXG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuXHRcdH1cclxuXHJcbiAgICBwcml2YXRlIG9uQ29tbWFuZChjb21tYW5kKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdDb21tYW5kOiAnICsgY29tbWFuZCk7XHJcbiAgICAgIGlmIChjb21tYW5kID09ICdtb3ZlJykge1xyXG4gICAgICAgIHRoaXMucGxheWVyLk1vdmUoKTtcclxuICAgICAgICB0aGlzLm1hcC5EaXNwbGF5KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHR9XHJcbn0iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiR2FtZS50c1wiLz5cclxuXHJcbnZhciBjb21tYW5kSW5wdXQgPSA8SFRNTFRleHRBcmVhRWxlbWVudD5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29tbWFuZCcpO1xyXG52YXIgbWFwID0gPEhUTUxEaXZFbGVtZW50PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAnKTtcclxuXHJcbnZhciBnYW1lID0gbmV3IENtMmsxNS5HYW1lKG1hcCwgY29tbWFuZElucHV0KTtcclxuXHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
